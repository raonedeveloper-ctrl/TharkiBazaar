<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TharkiBazaar</title>
  <meta name="description" content="TharkiBazaar mobile-first landing page with blurred previews, Terabox downloads, and rotating ad placements.">
  <style>
    :root{
      --bg:#eef1f6;
      --text:#0f172a;
      --card:#ffffff;
      --line:#d8dee9;
      --muted:#5d6471;
      --button:#2563eb;
      --button-hover:#1d4ed8;
      --pill:#e2e8f0;
      --accent:#f1f5ff;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      background:var(--bg);
      color:var(--text);
      font-family:"Segoe UI",Arial,sans-serif;
      line-height:1.55;
      padding-bottom:120px;
    }
    a{text-decoration:none;color:inherit;}
    header{
      padding:26px 16px 14px;
      text-align:center;
      font-weight:800;
      font-size:clamp(1.8rem,2vw + 1rem,2.8rem);
      letter-spacing:0.08em;
    }
    header span{display:inline-block;}
    [hidden]{display:none !important;}
    .page{
      max-width:1300px;
      margin:0 auto;
      padding:0 20px 40px;
      display:flex;
      flex-direction:column;
      gap:24px;
    }
    .panel{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:18px;
      box-shadow:0 10px 24px rgba(15,23,42,0.05);
    }
    .panel:not(.stats-panel){
      backdrop-filter:blur(2px);
    }
    .layout{
      display:grid;
<<<<<<< HEAD
      grid-template-columns:210px minmax(0,1fr) 320px;
=======
      grid-template-columns:210px minmax(0,1fr) 320px;
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
      gap:20px;
      align-items:start;
    }
    .sidebar-left,
    .sidebar-right{
      display:flex;
      flex-direction:column;
      gap:20px;
    }
    .main-column{
      display:flex;
      flex-direction:column;
      gap:20px;
    }
    .gallery{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(190px,1fr));
      gap:20px;
    }
    .card{
      border:1px solid var(--line);
      border-radius:16px;
      background:var(--card);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      padding:16px;
      transition:transform 0.18s ease, box-shadow 0.18s ease;
      overflow:hidden;
    }
    .card:hover{
      transform:translateY(-4px);
      box-shadow:0 18px 32px rgba(15,23,42,0.09);
    }
    .thumb{
      position:relative;
      background:var(--accent);
      border-radius:14px;
      overflow:hidden;
      width:100%;
      min-height:210px;
    }
    .thumb::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(180deg,rgba(15,23,42,0.12),rgba(15,23,42,0.32));
      pointer-events:none;
    }
    @supports (aspect-ratio: 3 / 4){
      .thumb{
        min-height:auto;
        aspect-ratio:3 / 4;
      }
    }
    .thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      object-position:center top;
      filter:blur(12px);
      transform:scale(1.08);
      pointer-events:none;
      user-select:none;
    }
    .eye-off{
      position:absolute;
      top:10px;
      right:10px;
      background:rgba(15,23,42,0.78);
      border-radius:999px;
      padding:6px 7px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 6px 12px rgba(15,23,42,0.25);
    }
    .eye-off svg{
      display:block;
      width:20px;
      height:20px;
      fill:#f8fafc;
    }
    .card-body{
      padding:0;
      display:flex;
      flex-direction:column;
      gap:10px;
      flex:1 1 auto;
      align-items:center;
    }
    .card-title{
      font-size:0.9rem;
      font-weight:600;
      color:var(--muted);
      letter-spacing:0.02em;
    }
    .card-actions{
      display:flex;
      justify-content:center;
      margin-top:auto;
      width:100%;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background:var(--button);
      color:#fff;
      font-weight:600;
      border-radius:14px;
      padding:10px 18px;
      min-width:0;
      width:100%;
      max-width:200px;
      font-size:0.95rem;
      transition:background 0.2s ease, transform 0.2s ease;
      box-shadow:0 8px 18px rgba(37,99,235,0.18);
    }
    .btn:hover{background:var(--button-hover);}
    .btn:focus-visible{
      outline:3px solid rgba(37,99,235,0.35);
      outline-offset:2px;
    }
    .ad-slot{
      width:100%;
      min-height:60px;
      border:1px dashed #cbd5e1;
      border-radius:14px;
      background:var(--accent);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      padding:8px;
    }
    .ad-slot span{
      font-size:0.85rem;
      color:var(--muted);
      opacity:0.8;
    }
    .ad-slot iframe{
      display:block;
      margin:0 auto;
      border:0;
    }
    .stats-panel{
      display:flex;
      flex-direction:column;
      gap:18px;
    }
    .stats-header{
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }
    .stats-actions{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:wrap;
      gap:10px;
    }
    .stats-header h2{
      font-size:1.1rem;
      letter-spacing:0.04em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .stats-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
      gap:16px;
    }
    .stats-card{
      padding:14px 16px;
      border-radius:14px;
      background:var(--accent);
      border:1px solid var(--line);
      display:flex;
      flex-direction:column;
      gap:6px;
      }
    .stats-card span{
      font-size:0.75rem;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:var(--muted);
    }
    .stats-card strong{
      font-size:1.4rem;
      font-weight:700;
    }
    .stats-details{
      border-radius:14px;
      background:var(--pill);
      padding:14px 16px;
      font-size:0.9rem;
      color:var(--muted);
    }
    .stats-details ul{
      margin-top:10px;
      list-style:disc;
      padding-left:20px;
      display:grid;
      gap:6px;
    }
    .stats-actions button{
      background:var(--button);
      color:#fff;
      border:none;
      padding:9px 16px;
      border-radius:14px;
      font-weight:600;
      cursor:pointer;
      transition:background 0.2s ease, transform 0.2s ease;
      box-shadow:0 6px 14px rgba(37,99,235,0.17);
    }
    .stats-actions button:hover{
      background:var(--button-hover);
      transform:translateY(-1px);
    }
    .sticky-footer{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      z-index:200;
      background:rgba(255,255,255,0.95);
      border-top:1px solid var(--line);
      backdrop-filter:blur(4px);
      padding:10px 0;
    }
    .sticky-inner{
      max-width:540px;
      margin:0 auto;
      padding:0 16px;
    }
    .admin-indicator{
      position:fixed;
      top:16px;
      right:16px;
      background:rgba(29,78,216,0.95);
      color:#fff;
      padding:9px 18px;
      border-radius:999px;
      font-size:0.78rem;
      letter-spacing:0.12em;
      text-transform:uppercase;
      box-shadow:0 12px 24px rgba(29,78,216,0.28);
      z-index:520;
    }
    .admin-toast{
      position:fixed;
      bottom:110px;
      right:16px;
      background:#0f172a;
      color:#f8fafc;
      padding:12px 18px;
      border-radius:12px;
      font-size:0.85rem;
      box-shadow:0 12px 32px rgba(15,23,42,0.35);
      opacity:0;
      transform:translateY(12px);
      transition:opacity 0.25s ease, transform 0.25s ease;
      z-index:520;
    }
    .admin-toast.show{
      opacity:0.95;
      transform:translateY(0);
    }
<<<<<<< HEAD
    @media (max-width:1100px){
      .layout{
        grid-template-columns:minmax(0,1fr);
        gap:16px;
      }
      .sidebar-left,
      .sidebar-right{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
        gap:16px;
        order:2;
      }
      .main-column{order:1;}
    }
    @media (max-width:780px){
      .layout{grid-template-columns:1fr;}
      .sidebar-left,
      .sidebar-right{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
        gap:14px;
        order:2;
      }
      .main-column{order:1;}
      .panel{padding:18px;}
      .gallery{grid-template-columns:repeat(2,minmax(0,1fr));}
      body{padding-bottom:140px;}
      .stats-header h2{font-size:1rem;}
    }
    @media (max-width:520px){
      .btn{width:100%;}
    }
=======
    @media (max-width:1100px){
      .layout{
        grid-template-columns:minmax(0,1fr);
        gap:16px;
      }
      .sidebar-left,
      .sidebar-right{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
        gap:16px;
        order:2;
      }
      .main-column{order:1;}
    }
    @media (max-width:780px){
      .layout{grid-template-columns:1fr;}
      .sidebar-left,
      .sidebar-right{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
        gap:14px;
        order:2;
      }
      .main-column{order:1;}
      .panel{padding:18px;}
      .gallery{grid-template-columns:repeat(2,minmax(0,1fr));}
      body{padding-bottom:140px;}
      .stats-header h2{font-size:1rem;}
    }
    @media (max-width:520px){
      .btn{width:100%;}
    }
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
    @media (min-width:768px){
      .gallery{grid-template-columns:repeat(3,minmax(190px,1fr));}
    }
    @media (min-width:1200px){
      .gallery{grid-template-columns:repeat(5,minmax(190px,1fr));}
    }
  </style>
</head>
<body>
  <header>
    <span>TharkiBazaar</span>
  </header>
  <div id="admin-indicator" class="admin-indicator" hidden>ADMIN MODE</div>
  <main class="page">
    <section id="stats-panel" class="panel stats-panel" aria-live="polite" hidden>
      <div class="stats-header">
        <h2>Activity Snapshot</h2>
        <div class="stats-actions">
          <button type="button" id="stats-copy-link">Copy Smartlink</button>
          <button type="button" id="stats-refresh-ads">Refresh Ads</button>
          <button type="button" id="stats-export">Export JSON</button>
          <button type="button" id="stats-reset">Reset Stats</button>
        </div>
      </div>
      <div class="stats-grid">
        <div class="stats-card">
          <span>Total Visits</span>
          <strong data-stat="visits">0</strong>
        </div>
        <div class="stats-card">
          <span>Downloads</span>
          <strong data-stat="downloads">0</strong>
        </div>
        <div class="stats-card">
          <span>Outbound Clicks</span>
          <strong data-stat="outbound">0</strong>
        </div>
        <div class="stats-card">
          <span>Ad Impressions</span>
          <strong data-stat="impressions">0</strong>
        </div>
        <div class="stats-card">
          <span>Ad Clicks</span>
          <strong data-stat="adclicks">0</strong>
        </div>
        <div class="stats-card">
          <span>Last Update</span>
          <strong data-stat="updated">--</strong>
        </div>
      </div>
      <div class="stats-details" id="stats-details">
        No activity tracked yet. Interactions on this device will show up here.
      </div>
    </section>
    <div class="layout">
<<<<<<< HEAD
      <aside class="sidebar-left">
        <div class="panel">
          <div id="slot-left-1" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-2" class="ad-slot" style="min-height:300px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-3" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-4" class="ad-slot" style="min-height:300px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-5" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
      </aside>
=======
      <aside class="sidebar-left">
        <div class="panel">
          <div id="slot-left-1" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-2" class="ad-slot" style="min-height:300px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-3" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-4" class="ad-slot" style="min-height:300px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-left-5" class="ad-slot" style="min-height:600px;">
            <span>Advertisement</span>
          </div>
        </div>
      </aside>
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
      <section class="main-column">
        <div class="panel">
          <div class="gallery">
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 01" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 01</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1524502397800-808dc0fef78d?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 02" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 02</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 03" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 03</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 04" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 04</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1507692049790-de58290a4334?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 05" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 05</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1502767089025-6572583495b0?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 06" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 06</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 07" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 07</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 08" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 08</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1521570167421-1afc82db536a?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 09" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 09</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="thumb">
                <span class="eye-off">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M2.1 3.51 3.51 2.1l18.39 18.39-1.41 1.41-2.54-2.54A11.26 11.26 0 0 1 12 20.25c-4.6 0-8.6-2.73-11-7.25a12.77 12.77 0 0 1 4.11-4.59L2.1 3.51Zm12.24 12.24-1.74-1.74a2.75 2.75 0 0 1-3.62-3.62L7.61 7.88A7.49 7.49 0 0 0 4.2 12a9.73 9.73 0 0 0 3.47 3.7A9.63 9.63 0 0 0 12 17.5a7.49 7.49 0 0 0 2.34-.36ZM9.5 6.62l1.45 1.45a2.75 2.75 0 0 1 3.98 3.7l1.51 1.51A7.52 7.52 0 0 0 19.8 12a9.73 9.73 0 0 0-3.47-3.7A9.63 9.63 0 0 0 12 6.5a7.5 7.5 0 0 0-2.5.12Z"/>
                  </svg>
                </span>
                <img src="https://images.unsplash.com/photo-1544723795-3fb6469f5b39?auto=format&amp;fit=crop&amp;w=800&amp;q=80" alt="Blurred female preview 10" loading="lazy">
              </div>
              <div class="card-body">
                <div class="card-title">Preview 10</div>
                <div class="card-actions">
                  <a class="btn dl" href="https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA" target="_blank" rel="noopener noreferrer nofollow">Download Now</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
<<<<<<< HEAD
      <aside class="sidebar-right">
        <div class="panel">
          <div id="slot-right-1" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-2" class="ad-slot" style="min-height:120px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-3" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-4" class="ad-slot" style="min-height:120px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-5" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
      </aside>
    </div>
  </main>
  <div id="admin-toast" class="admin-toast" role="status" aria-live="assertive" hidden></div>
=======
      <aside class="sidebar-right">
        <div class="panel">
          <div id="slot-right-1" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-2" class="ad-slot" style="min-height:120px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-3" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-4" class="ad-slot" style="min-height:120px;">
            <span>Advertisement</span>
          </div>
        </div>
        <div class="panel">
          <div id="slot-right-5" class="ad-slot" style="min-height:250px;">
            <span>Advertisement</span>
          </div>
        </div>
      </aside>
    </div>
  </main>
  <div id="admin-toast" class="admin-toast" role="status" aria-live="assertive" hidden></div>
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
  <script src="https://pl27733128.revenuecpmgate.com/aa/5f/65/aa5f65bd170576514aff7ed9f749c09c.js"></script>
  <script src="https://pl27745183.revenuecpmgate.com/13/1f/fe/131ffed8b4e68b9b3eab58113d5a2ccf.js"></script>
  <script>
    (function(){
      const TERABOX_URL = 'https://www.1024tera.com/sharing/link?surl=PfOK7auKQ_ynPhfgWYjeqA';
      const SMARTLINK_URL = 'https://www.revenuecpmgate.com/xf7ermdz85?key=b269d3dd076f7f0bc87132f84bb60eeb';
      const downloadButtons = document.querySelectorAll('.dl');
      downloadButtons.forEach((btn, idx) => {
        btn.href = TERABOX_URL;
        btn.dataset.index = String(idx + 1);
      });

      const ADMIN_PASSWORD = 'Raone'; // TODO: replace with your secret passphrase
      const ADMIN_FLAG_KEY = 'tharkibazaar.admin.active';
      const statsPanel = document.getElementById('stats-panel');
<<<<<<< HEAD
      const adminIndicator = document.getElementById('admin-indicator');
      const adminToast = document.getElementById('admin-toast');
=======
      const adminIndicator = document.getElementById('admin-indicator');
      const adminToast = document.getElementById('admin-toast');
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
      let adminToastTimer = null;
      let adminToastHideTimer = null;

      if(ADMIN_PASSWORD === 'Raone'){
        console.warn('TharkiBazaar: Update ADMIN_PASSWORD with your own secret before publishing.');
      }

      function setAdminUI(enabled){
        if(statsPanel){
          statsPanel.hidden = !enabled;
        }
        if(adminIndicator){
          adminIndicator.hidden = !enabled;
        }
      }

      function showAdminToast(message, duration){
        if(!adminToast){ return; }
        const displayMs = typeof duration === 'number' ? duration : 2200;
        adminToast.textContent = message;
        adminToast.hidden = false;
        adminToast.classList.add('show');
        if(adminToastTimer){ clearTimeout(adminToastTimer); }
        if(adminToastHideTimer){ clearTimeout(adminToastHideTimer); }
        adminToastTimer = setTimeout(() => {
          adminToast.classList.remove('show');
          adminToastHideTimer = setTimeout(() => {
            adminToast.hidden = true;
          }, 260);
        }, displayMs);
      }

      function unlockAdminPrompt(){
        const passphrase = window.prompt('Enter admin passphrase:');
        if(!passphrase){ return; }
        if(passphrase === ADMIN_PASSWORD){
          try{
            sessionStorage.setItem(ADMIN_FLAG_KEY, '1');
          }catch(err){}
          setAdminUI(true);
          if(typeof renderStats === 'function'){
            renderStats();
          }
          showAdminToast('Admin tools unlocked');
        }else{
          window.alert('Incorrect passphrase.');
        }
      }

      function lockAdmin(){
        const wasActive = statsPanel ? !statsPanel.hidden : false;
        try{
          sessionStorage.removeItem(ADMIN_FLAG_KEY);
        }catch(err){}
        setAdminUI(false);
        if(wasActive){
          showAdminToast('Admin view disabled');
        }
      }

      function initAdminState(){
        let enabled = false;
        try{
          enabled = sessionStorage.getItem(ADMIN_FLAG_KEY) === '1';
        }catch(err){}
        setAdminUI(enabled);
      }

      initAdminState();

      document.addEventListener('keydown', event => {
        if(event.ctrlKey && event.altKey && event.key && event.key.toLowerCase() === 'a'){
          event.preventDefault();
          unlockAdminPrompt();
        }
        if(event.ctrlKey && event.altKey && event.key && event.key.toLowerCase() === 'l'){
          event.preventDefault();
          lockAdmin();
        }
      });

      const header = document.querySelector('header');
      if(header){
        let headerPressTimer = null;
        header.addEventListener('mousedown', () => {
          headerPressTimer = setTimeout(() => {
            unlockAdminPrompt();
          }, 1400);
        });
        header.addEventListener('mouseup', () => {
          if(headerPressTimer){
            clearTimeout(headerPressTimer);
            headerPressTimer = null;
          }
        });
        header.addEventListener('mouseleave', () => {
          if(headerPressTimer){
            clearTimeout(headerPressTimer);
            headerPressTimer = null;
          }
        });
        header.addEventListener('touchstart', () => {
          headerPressTimer = setTimeout(() => {
            unlockAdminPrompt();
          }, 1400);
        }, { passive: true });
        const clearHeaderTimer = () => {
          if(headerPressTimer){
            clearTimeout(headerPressTimer);
            headerPressTimer = null;
          }
        };
        header.addEventListener('touchend', clearHeaderTimer);
        header.addEventListener('touchcancel', clearHeaderTimer);
      }

<<<<<<< HEAD
      const STORAGE_KEY = 'tharkibazaar.metrics.v1';
=======
      const STORAGE_KEY = 'tharkibazaar.metrics.v1';
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379
      function createBlankStats(){
        return {
          visits:0,
          downloads:0,
          outboundClicks:0,
          adImpressions:{},
          adClicks:{},
          downloadsPerItem:{},
          updated:null
        };
      }

      let storageAvailable = true;
      try{
        const probeKey = '__tbz_probe__';
        localStorage.setItem(probeKey, 'ok');
        localStorage.removeItem(probeKey);
      }catch(err){
        storageAvailable = false;
      }

      function loadStats(){
        const fallback = createBlankStats();
        if(!storageAvailable){ return fallback; }
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          if(!raw){ return fallback; }
          const parsed = JSON.parse(raw);
          return {
            ...fallback,
            ...parsed,
            adImpressions:{...fallback.adImpressions, ...(parsed.adImpressions || {})},
            adClicks:{...fallback.adClicks, ...(parsed.adClicks || {})},
            downloadsPerItem:{...fallback.downloadsPerItem, ...(parsed.downloadsPerItem || {})}
          };
        }catch(err){
          console.warn('Unable to load stored stats', err);
          return fallback;
        }
      }

      const stats = loadStats();

      function persistStats(){
        if(!storageAvailable){ return; }
        try{
          localStorage.setItem(STORAGE_KEY, JSON.stringify(stats));
        }catch(err){
          console.warn('Unable to persist stats', err);
        }
      }

      const statsNodes = {
        visits: document.querySelector('[data-stat="visits"]'),
        downloads: document.querySelector('[data-stat="downloads"]'),
        outbound: document.querySelector('[data-stat="outbound"]'),
        impressions: document.querySelector('[data-stat="impressions"]'),
        adclicks: document.querySelector('[data-stat="adclicks"]'),
        updated: document.querySelector('[data-stat="updated"]'),
        details: document.getElementById('stats-details')
      };
      const exportButton = document.getElementById('stats-export');
      const refreshAdsButton = document.getElementById('stats-refresh-ads');
      const copyLinkButton = document.getElementById('stats-copy-link');

      function formatNumber(value){
        return typeof value === 'number' && typeof value.toLocaleString === 'function'
          ? value.toLocaleString()
          : String(value);
      }

      function renderStats(){
        if(!statsNodes.visits){ return; }
        const totalImpressions = Object.values(stats.adImpressions || {}).reduce((sum, val) => sum + Number(val || 0), 0);
        const totalAdClicks = Object.values(stats.adClicks || {}).reduce((sum, val) => sum + Number(val || 0), 0);

        if(statsNodes.visits){
          statsNodes.visits.textContent = formatNumber(stats.visits || 0);
        }
        if(statsNodes.downloads){
          statsNodes.downloads.textContent = formatNumber(stats.downloads || 0);
        }
        if(statsNodes.outbound){
          statsNodes.outbound.textContent = formatNumber(stats.outboundClicks || 0);
        }
        if(statsNodes.impressions){
          statsNodes.impressions.textContent = formatNumber(totalImpressions);
        }
        if(statsNodes.adclicks){
          statsNodes.adclicks.textContent = formatNumber(totalAdClicks);
        }

        if(statsNodes.updated){
          if(stats.updated){
            const parsed = new Date(stats.updated);
            statsNodes.updated.textContent = isNaN(parsed.getTime()) ? stats.updated : parsed.toLocaleString();
          }else{
            statsNodes.updated.textContent = '--';
          }
        }

        if(!statsNodes.details){ return; }
        const sections = [];
        const downloadsPerItem = Object.entries(stats.downloadsPerItem || {});
        if(downloadsPerItem.length){
          const items = downloadsPerItem
            .sort((a, b) => Number(a[0]) - Number(b[0]))
            .map(([idx, count]) => `<li>Preview ${String(idx).padStart(2,'0')}: ${formatNumber(count)}</li>`);
          sections.push(`<strong>Downloads per preview</strong><ul>${items.join('')}</ul>`);
        }
        const impressionsPerSlot = Object.entries(stats.adImpressions || {});
        if(impressionsPerSlot.length){
          const items = impressionsPerSlot
            .sort()
            .map(([slot, count]) => `<li>${slot}: ${formatNumber(count)}</li>`);
          sections.push(`<strong>Ad impressions by slot</strong><ul>${items.join('')}</ul>`);
        }
        const adClicksPerSlot = Object.entries(stats.adClicks || {});
        if(adClicksPerSlot.length){
          const items = adClicksPerSlot
            .sort()
            .map(([slot, count]) => `<li>${slot}: ${formatNumber(count)}</li>`);
          sections.push(`<strong>Ad slot wrapper clicks</strong><ul>${items.join('')}</ul>`);
        }
        if(sections.length){
          statsNodes.details.innerHTML = `<strong>Stored locally on this device.</strong>${sections.join('')}`;
        }else{
          statsNodes.details.textContent = 'Stats are saved locally in this browser. Interact with downloads or ads to populate more detail.';
        }
      }

      function updateStats(mutator){
        if(typeof mutator === 'function'){
          mutator(stats);
        }
        stats.updated = new Date().toISOString();
        persistStats();
        renderStats();
      }

      const resetButton = document.getElementById('stats-reset');
      if(resetButton){
        resetButton.addEventListener('click', () => {
          const ok = window.confirm('Clear stored activity stats for this browser?');
          if(!ok){ return; }
          const fresh = createBlankStats();
          Object.keys(stats).forEach(key => { delete stats[key]; });
          Object.assign(stats, fresh);
          if(storageAvailable){
            try{
              localStorage.removeItem(STORAGE_KEY);
            }catch(err){}
          }
          renderStats();
          showAdminToast('Stats cleared');
        });
      }

      if(exportButton){
        exportButton.addEventListener('click', () => {
          const snapshot = JSON.stringify(stats, null, 2);
          try{
            const blob = new Blob([snapshot], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const anchor = document.createElement('a');
            anchor.href = url;
            anchor.download = 'tharkibazaar-stats.json';
            document.body.appendChild(anchor);
            anchor.click();
            setTimeout(() => {
              document.body.removeChild(anchor);
              URL.revokeObjectURL(url);
            }, 0);
            showAdminToast('Stats exported');
          }catch(err){
            console.error('Unable to export stats', err);
            window.alert('Unable to export stats. See console for details.');
          }
        });
      }

      if(refreshAdsButton){
        refreshAdsButton.addEventListener('click', () => {
          try{
            refreshAllAds();
            showAdminToast('Ad slots refreshed');
          }catch(err){
            console.error('Unable to refresh ads', err);
            window.alert('Unable to refresh ads right now.');
          }
        });
      }

      function copyText(value){
        if(!value){ return Promise.reject(new Error('Nothing to copy')); }
        if(navigator.clipboard && navigator.clipboard.writeText){
          return navigator.clipboard.writeText(value);
        }
        return new Promise((resolve, reject) => {
          const textarea = document.createElement('textarea');
          textarea.value = value;
          textarea.setAttribute('readonly', '');
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.select();
          try{
            const success = document.execCommand('copy');
            document.body.removeChild(textarea);
            return success ? resolve() : reject(new Error('Copy command rejected'));
          }catch(err){
            document.body.removeChild(textarea);
            reject(err);
          }
        });
      }

<<<<<<< HEAD
      if(copyLinkButton){
        copyLinkButton.addEventListener('click', () => {
          copyText(SMARTLINK_URL).then(() => {
            showAdminToast('Smartlink copied');
          }).catch(err => {
            console.error('Failed to copy smartlink', err);
            window.prompt('Copy the smartlink manually:', SMARTLINK_URL);
          });
        });
      }
=======
      if(copyLinkButton){
        copyLinkButton.addEventListener('click', () => {
          copyText(SMARTLINK_URL).then(() => {
            showAdminToast('Smartlink copied');
          }).catch(err => {
            console.error('Failed to copy smartlink', err);
            window.prompt('Copy the smartlink manually:', SMARTLINK_URL);
          });
        });
      }
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379

      renderStats();
      updateStats(s => { s.visits = (s.visits || 0) + 1; });

      function clearNode(node){
        while(node.firstChild){
          node.removeChild(node.firstChild);
        }
      }

      const AD_LOAD_TIMEOUT = 3500;
      let adLoadQueue = Promise.resolve();

      function loadHP(target, key, width, height){
        if(!target){ return; }
        clearNode(target);
        target.style.minHeight = height + 'px';
        const configText = 'var atOptions={key:"' + key + '",format:"iframe",height:' + height + ',width:' + width + ',params:{}};';
        adLoadQueue = adLoadQueue.then(() => new Promise(resolve => {
          const configScript = document.createElement('script');
          configScript.type = 'text/javascript';
          configScript.text = configText;
          const loader = document.createElement('script');
          loader.type = 'text/javascript';
          loader.async = true;
          loader.src = 'https://www.highperformanceformat.com/' + key + '/invoke.js';
          let settled = false;
          const cleanup = () => {
            if(settled){ return; }
            settled = true;
            try{ delete window.atOptions; }catch(err){}
            resolve();
          };
          loader.onload = cleanup;
          loader.onerror = cleanup;
          setTimeout(cleanup, AD_LOAD_TIMEOUT);
          target.appendChild(configScript);
          target.appendChild(loader);
        })).catch(err => {
          console.error('Ad queue error', err);
        });
      }

      const SIZES = {
        k300x250:'72b7232ca3ae40f63836f3c472360365',
        k728x90:'518bb62c4fe828a47ab0530ed37ad2bf',
        k160x600:'d36c2f4dfc3863469f3b2132607617c6',
        k160x300:'9ab75744061e372e002498c8b7270b8e',
        k468x60:'4e4e54cb42e36c5eb4dc8ab45feeefb9',
        k320x50:'b7193586f4106b807d27a90a71d22c37'
      };

<<<<<<< HEAD
      const plan = {
        'slot-left-1': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-left-2': [
          el => loadHP(el, SIZES.k160x300, 160, 300)
        ],
        'slot-left-3': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-left-4': [
          el => loadHP(el, SIZES.k160x300, 160, 300)
        ],
        'slot-left-5': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-right-1': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ],
        'slot-right-2': [
          el => loadHP(el, SIZES.k320x50, 320, 50)
        ],
        'slot-right-3': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ],
        'slot-right-4': [
          el => loadHP(el, SIZES.k320x50, 320, 50)
        ],
        'slot-right-5': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ]
      };
=======
      const plan = {
        'slot-left-1': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-left-2': [
          el => loadHP(el, SIZES.k160x300, 160, 300)
        ],
        'slot-left-3': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-left-4': [
          el => loadHP(el, SIZES.k160x300, 160, 300)
        ],
        'slot-left-5': [
          el => loadHP(el, SIZES.k160x600, 160, 600)
        ],
        'slot-right-1': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ],
        'slot-right-2': [
          el => loadHP(el, SIZES.k320x50, 320, 50)
        ],
        'slot-right-3': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ],
        'slot-right-4': [
          el => loadHP(el, SIZES.k320x50, 320, 50)
        ],
        'slot-right-5': [
          el => loadHP(el, SIZES.k300x250, 300, 250)
        ]
      };
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379

      const ACTIVE_INDEX = {};
      function rotateSlot(id){
        const el = document.getElementById(id);
        const handlers = plan[id];
        if(!el || !handlers || handlers.length === 0){ return; }
        const next = ((ACTIVE_INDEX[id] ?? -1) + 1) % handlers.length;
        ACTIVE_INDEX[id] = next;
        try{
          handlers[next](el);
        }catch(err){
          console.error('Ad load error for', id, err);
        }
      }

      function refreshAllAds(){
        Object.keys(plan).forEach(rotateSlot);
      }

<<<<<<< HEAD
      refreshAllAds();
=======
      refreshAllAds();
>>>>>>> c7b56fc5b0f55147e1f5c9f999e63b10c6c26379

      const GA_ID = 'G-XXXXXXX';
      if(GA_ID && GA_ID !== 'G-XXXXXXX'){
        const gaScript = document.createElement('script');
        gaScript.async = true;
        gaScript.src = 'https://www.googletagmanager.com/gtag/js?id=' + GA_ID;
        document.head.appendChild(gaScript);
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        window.gtag = gtag;
        gtag('js', new Date());
        gtag('config', GA_ID);
      }

      function sendGA(name, params){
        if(typeof window.gtag === 'function'){
          window.gtag('event', name, params || {});
        }
      }

      sendGA('page_visit', { page: location.pathname || 'index.html' });

      downloadButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          updateStats(state => {
            state.downloads = (state.downloads || 0) + 1;
            state.downloadsPerItem = state.downloadsPerItem || {};
            const itemIndex = btn.dataset.index || '0';
            state.downloadsPerItem[itemIndex] = (state.downloadsPerItem[itemIndex] || 0) + 1;
          });
          sendGA('download_click', { item_index: Number(btn.dataset.index) || 0 });
        });
      });

      document.addEventListener('click', evt => {
        const anchor = evt.target.closest('a[href]');
        if(!anchor){ return; }
        try{
          const url = new URL(anchor.href, location.href);
          if(url.origin !== location.origin){
            updateStats(state => {
              state.outboundClicks = (state.outboundClicks || 0) + 1;
            });
            sendGA('outbound_click', { href: anchor.href });
          }
        }catch(err){}
      });

      const seenSlots = new Set();
      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if(entry.isIntersecting && !seenSlots.has(entry.target.id)){
            seenSlots.add(entry.target.id);
            updateStats(state => {
              const slotId = entry.target.id || 'ad-slot';
              state.adImpressions = state.adImpressions || {};
              state.adImpressions[slotId] = (state.adImpressions[slotId] || 0) + 1;
            });
            sendGA('ad_impression', { slot_id: entry.target.id });
            observer.unobserve(entry.target);
          }
        });
      }, { rootMargin: '0px 0px -20% 0px' });

      document.querySelectorAll('.ad-slot').forEach(slot => {
        observer.observe(slot);
        slot.addEventListener('click', () => {
          updateStats(state => {
            const slotId = slot.id || 'ad-slot';
            state.adClicks = state.adClicks || {};
            state.adClicks[slotId] = (state.adClicks[slotId] || 0) + 1;
          });
          sendGA('ad_slot_click_proxy', { slot_id: slot.id });
        }, { passive: true, capture: true });
      });
    })();
  </script>
</body>
</html>
